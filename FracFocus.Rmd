---
title: "Final Project"
author: "Shaun Donmoyer"
date: "10/23/2019"
output: html_document
---

# Load appropriate library

```{r}
library(odbc)
```

#Connect to database
```{r}
con <- dbConnect(odbc(),Driver="SQL Server",Server="localhost\\SQLEXPRESS", Database="FracFocusRegistry", Trusted_Connection="True") 
```

#Retreives all disclosures from Regisitry Upload Purpose
```{r}
RUP <- data.table(dbGetQuery(con, "SELECT * FROM [FracFocusRegistry].[dbo].[RegistryUploadPurpose]"))
```


# All Disclosures that include Acetic Acid
```{r}
Acetic <- data.table(dbGetQuery(con, "SELECT * FROM RegistryUploadIngredients Where IngredientName = 'Acetic Acid';"))
```

# All Disclosures that include Ammonium Persulfate
```{r}
AMPSF <- data.table(dbGetQuery(con, "SELECT * FROM RegistryUploadIngredients Where IngredientName = 'Ammonium Persulfate';"))
```

# All Breakers
```{r}
Breaker <- data.table(dbGetQuery(con, "SELECT * FROM RegistryUploadPurpose WHERE Purpose = 'Breaker';"))
```

# Breaker Trade Name and Frequency
```{r}
library(plyr)
Br_Freq <- count(Breaker, "TradeName")
```

```{r}
top10_Br <- Br_Freq[c(610,578,315,469,374,313,561,452,222,318),]
```

```{r}
Br_plot <- qplot(TradeName, freq, data=top10_Br, main="Top 10 most used Breakers in FracFocus", xlab="TradeName", ylab="Frequency")
```

```{r}
Br_Plot <- ggplot(top10_Br, aes(x=TradeName, y=freq)) + geom_bar(stat="identity", color="blue",fill="white") + 
     labs(x="TradeName", y="Frequency",title="10 Most Used Breakers in FracFocus")+geom_text(aes(label=freq), vjust=1.6, color="black", size=3.5)+theme(axis.text.x=element_text(size=10,angle=45,hjust=1,vjust=1))

Br_Plot
```


```{r}
br_report <- function(breaker){
  new_data <- Br_Freq[Br_Freq$freq == "freq", ]
    return(new_data)
}
```  
  

